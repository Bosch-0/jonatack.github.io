<!--

jon atack bitcoin core developer and protocol researcher

-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>jon atack - How to Open Bitcoin Core PRs</title>
    <meta charset="utf-8">
    <base target="_blank">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="/style.css" />
  </head>

  <body>
    <div id="content">
      <div id="right">
        <div class="list">
          <ul>
            <li>
              <a href="/" target="_self">home</a>
            </li>
            <li>
              <a href="/articles" target="_self">articles</a>
            </li>
            <li>
              <a href="/presentations" target="_self">presentations</a>
            </li>
            <li>
              <a href="/sponsors" target="_self">sponsors</a>
            </li>
            <li>
              <a href="/contact" target="_self">contact</a>
            </li>
            <li>
              <a href="/donate" target="_self">donate</a>
            </li>

            <style scoped>
              @media (max-width: 600px) { .rc-scout { float: none !important;
                                                      display: inline-block
                                                                 !important; } }
            </style>
            <li>
              <div class="rc-scout"
                   style="height:1.2em;width:1.2em;float:right;"></div>
            </li>
          </ul>
        </div>
        <div class="namecap">
          <a href="/" target="_self">jon~~<br>atack</a>
        </div>
      </div>

      <div id="entry_block">
        <div class="entry">
          <div class="date">Last updated: 20 January 2020</div>
          <div class="body">
            <article>
              <div class="title">How to Open Bitcoin Core PRs</div>

              <h3 id="before-you-begin">BEFORE YOU BEGIN</h3>

              <p>
                This guide builds on the foundation laid by
                <a href="how-to-review-bitcoin-core-prs" target="_self">How to
                  Review Bitcoin Core PRs</a>.
              </p>
              <p>
                Remember that reviewing is the most effective way you can
                contribute as a new contributor (and will teach you more about
                the codebase than opening PRs).
              </p>
              <p>
                As
                <a href="https://twitter.com/moneyball" target="_blank">Steve Lee</a>
                of
                <a href="https://twitter.com/sqcrypto" target="_blank">Square Crypto</a>
                wrote to me recently: "If literally all a developer did was
                review hard but important PRs it'd be incredibly valuable."
              </p>
              <p>
                Don't be in a hurry to add to the growing pile of open PRs.
              </p>
              <p>
                A good rule of thumb is to review 5-15 PRs (or solve or test
                5-15 open issues) for every PR you make.
              </p>

              <h3 id="how-to-contribute-pull-requests-to-bitcoin-core">HOW TO CONTRIBUTE PULL REQUESTS TO BITCOIN CORE</h3>

              <p>
                When you do start contributing PRs, here are some guidelines:
              </p>
              <p>
                Aim for quality over quantity and a balance between deep work
                and quick wins.
              </p>
              <p>
                Read and know the Bitcoin Core
                <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md">developer notes</a>.
              </p>

              <h4 id="what-to-do">What to do</h4>
              <p>
                Choose your contribution carefully to be sure it is desired by
                the maintainers and reviewers; without their approval, you risk
                squandering your time and social capital.
              </p>
              <p>
                The best place to look for good things to do as a new
                contributor is the
                <a href="https://github.com/bitcoin/bitcoin/contribute">"good
                  first issues" page</a>.
              </p>
              <p>
                Good ideas may also be found while doing
                <a href="https://github.com/bitcoin/bitcoin/pulls">PR reviews</a>
                and in
                <a href="https://webchat.freenode.net/?channels=bitcoin-core-dev"
                   rel="nofollow">#bitcoin-core-dev</a>

                IRC discussions when maintainers or experienced contributors
                mention nice-to-haves.
              </p>
              <p>
                Things to do and fix can also be found by searching for TODO and
                FIXME comments in the codebase. An easy way to do this is to
                run <code>git grep "TODO\|FIXME"</code> on the command line from
                root. Keep in mind that these comments can sometimes be out of
                date.
              </p>

              <h4 id="priorities">Priorities</h4>
              <p>
                Focus on user problems, actual bugs, and "used, but untested"
                methods that affect outcomes and need tests. Bitcoin Core is a
                large, legacy codebase and there are inconsistencies, but it's
                good to keep a healthy perspective on priorities. An item might
                seem fun to contribute, but before opening that PR, consider the
                review time you're asking for. Because of your PR, is a
                regression or CVE getting past a lack of review elsewhere?
              </p>
              <p>
                <a href="https://github.com/bitcoin/bitcoin/pull/17728#issuecomment-565803646">Try
                to solve a clearly defined issue with a clear, minimal
                change</a>.
              </p>
              <p>
                Avoid making trivial refactoring, style cleanup, or spelling
                PRs; these consume valuable contributor and maintainer time,
                often for little gain. Code churn can cause hidden new bugs and
                blurs the code history and git blame. Any code refactoring needs
                substantial motivation, advantages, or simplifications.
              </p>
              <p>
                Do not begin by trying to change consensus code; it is difficult
                and dangerous territory. The goal of Bitcoin Core is to maintain
                the correct consensus on the Bitcoin network â€” all else is
                secondary.
              </p>
              <p>
                As a general guideline, here are priorities in decreasing order:
                fixing bugs, improving security/test coverage, addressing real
                use cases, doing less/removing code (only when doing nothing
                isn't better), doing more/adding code.
              </p>

              <h4 id="gather-information">Gather information</h4>
              <p>
                Gather context about the change you have in mind. Has it already
                been proposed in the past? Do issues or PRs about it already
                exist? (They probably do). Sleuth a bit. Search the <code>git
                log -S</code> history. Look at the <code>git blame</code> of the
                code in question and <code>git show</code> the commits. Check
                the GitHub file history. You'll see who understands that part of
                the codebase and can be contacted for questions or review.
              </p>
              <p>
                It may save you a lot of time to consult with relevant people on
                IRC before tackling a difficult project in potentially the wrong
                way, or one that has already been tried and turned out to be a
                dead end for reasons that may not be apparent to you.
              </p>
              <p>
                I sometimes seek Concept ACKs for larger changes at IRC meetings
                (<a href="http://www.erisian.com.au/meetbot/bitcoin-core-dev/2020/bitcoin-core-dev.2020-01-17-19.00.log.html"
                    target="_blank">example</a>)
                as a topic request and discussion.
              </p>

              <h4 id="write-test-coverage">Write test coverage</h4>
              <p>
                Test coverage is essential; don't hesitate to write any missing
                <a href="https://github.com/bitcoin/bitcoin/tree/master/src/test">unit</a>,
                <a href="https://github.com/bitcoin/bitcoin/tree/master/test/functional">functional</a>, or
                <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/rapidcheck.md">property-based</a>
                tests, or improve the
                <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/fuzzing.md">fuzzing
                  tests</a>
                or
                <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/benchmarking.md">benchmarking</a>.
              </p>
              <p>
                A Gregory Maxwell warning to test contributors: "Overly exact
                tests have greatly diminished value if their exactitude turns
                them into hyper-active <em>something changed</em> detectors,
                when they would otherwise be more useful as <em>something isn't
                right</em> detectors if constructed more in terms of invariants
                instead of strict behaviour."
              </p>

              <h4 id="write-documentation">Write documentation</h4>
              <p>
                Documentation is important, e.g. high-level documentation of how
                things work and interact, clear and accurate code docs, whether
                a function has a good description and
                <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#coding-style-doxygen-compatible-comments">Doxygen
                  documentation</a>,
                test logging (both <code>info</code> and <code>debug</code>),
                and so on.
              </p>
              <p>
                Add
                <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#release-notes">release notes</a>
                when appropriate. RPC-related release notes should refer to the
                RPC help for details instead of substituting for full
                documentation, for example: "Please refer to the RPC help
                of <code>getbalances</code> for details."
               </p>
              <p>
                To avoid potential merge conflicts, release notes are usually
                added in a separate markdown file in the <code>/doc</code>
                directory named <code>release-notes-PR_NUMBER.md</code>, not
                directly in
                <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/release-notes.md"
                   target="_blank">doc/release-notes.md</a>.
              </p>

              <p>
                In general, PRs that intelligently improve documentation and
                tests in a well thought-out way tend to be well-received.
              </p>

              <h4 id="do-it-well">Do it well</h4>
              <p>
                Don't rush. Give your work time to mature, revisit it with fresh
                perspective, and iterate on it a few times before putting it out
                there and asking for others' time. It might be a good rule of
                thumb to write several WIP PRs for each one that you do file.
              </p>
              <p>
                Consider also the timing of what is going on in the project in
                terms of priorities and releases as well as your current
                status. If you already have a few PRs open it may be best to
                close them or concentrate on having them merged before adding
                yet another PR to the review stack. The idea of limiting open
                PRs to 5 per contributor is occasionally raised; consider
                staying well under that.
              </p>
              <p>
                Put the time in to make your PRs as easy to understand and
                review as possible: Code, tests, documentation, good commit
                messages, relevant references, concise explanations.
              </p>
              <p>
                Give some thought to PR size and scope. Many contributors err on
                the side of making their PRs too large and time-consuming to
                review. It is often better to keep your PRs short and focused to
                make them easier and safer to review. This may require splitting
                your work into several consecutive PRs.
              </p>
              <p>
                As described in the Bitcoin Core
                <a href="https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md">contributing guide</a>,
                prefix your PR title with the relevant area
                (e.g. <code>doc</code>, <code>test</code>, <code>rpc</code>, <code>wallet</code>),
                and become comfortable with frequently rebasing your commits to
                squash them. Rebasing is also frequently done to keep your
                commits logical, separate, and easier to review. Even better,
                hygienic â€” each standing on their own without introducing
                regressions.
              </p>
              <p>
                A PR prefixed or labelled as changing UI/UX can attract
                excessive bikeshedding. One tried-and-tested solution can be to
                make a minor UI fix or change as a commit inside a non-UI/UX PR
                that changes related items or code. The regular reviewers will
                see it, but few drive-by commentators will.
              </p>
              <p>
                PR descriptions are important. They "sell" your PR yet are often
                either too terse or too verbose. Write the essentials, then take
                the time to make your PR description brief, clear, even
                <a href="https://www.collinsdictionary.com/dictionary/english/pithy"
                   rel="nofollow">pithy</a>.
              </p>

              <h4 id="say-how-to-review-and-test-your-pr">
                Say how to review and test your PR
              </h4>
              <p>
                It's a smart habit to give reviewers tips in your PR description
                on how to review and test your changes: "Here's how to review
                this".
              </p>

              <h4 id="say-why">Say why</h4>
              <p>
                PR descriptions need to explain <em>why</em>. Summarizing
                "what" can be good too, but "why" is essential to review because
                if the why doesn't make sense then the what probably doesn't
                matter. Sometimes things seem self-apparent, but when in doubt
                no one was ever hurt by a little more concise explanation.
              </p>

              <p>
                Don't rely on markdown in your PR description for it to make
                sense, especially strike-through formatting. The Bitcoin Core
                merge script will copy your PR description to git history in the
                merge commit but any formatting will be lost.
              </p>
              <p>
                For simple edits of existing commits, don't hesitate to squash
                your commits before pushing, without waiting for the maintainers
                to ask you to do so.
              </p>
              <p>
                Set up Travis CI on your own GitHub Bitcoin repository so that
                when you push a branch or commit, the linter and continuous
                integration tests run. It can be a good idea to verify that they
                are all green on your GitHub repository before filing a
                PR. Unfortunately, the Travis CI is also currently very slow and
                times out frequently, signaling false negatives.
              </p>
              <p>When it works,
                <a href="https://bitcoinbuilds.org"
                   rel="nofollow">https://bitcoinbuilds.org</a>
                runs more quickly than the Travis CI (but for the moment it
                tests fewer platforms), so don't hesitate to consult it for
                early initial feedback when you push a PR or changes.
              </p>
              <p>
                You can sign your commits using the
                <a href="https://github.com/opentimestamps/opentimestamps-client/blob/master/doc/git-integration.md">OpenTimestamps
                Git Integration</a>.
                It's easy to setup.
              </p>
              <p>
                Remember that every time you comment on your PR after pushing,
                you're sending notifications to the people who previously
                reviewed or commented on it. Respect their time.
              </p>
              <p>
                Learn how to get people to review your work when needed. It's a
                skill.
              </p>
              <p>
                Persistence can pay off. Sometimes a PR succeeds on the second
                or
                <a href="https://github.com/bitcoin/bitcoin/pull/16060">third
                  try</a>
                if the first ones didn't see enough review and if there are
                valid reasons to continue.
              </p>
              <p>
                In this case,
                <a href="https://github.com/bitcoin/bitcoin/pull/16060#issuecomment-494142593">one
                  idea seen in practice</a>
                is to recap various ACKs from the previous PRs, with GitHub
                usernames, to rope in support for the new PR. If you do, be sure
                to do it in a comment â€” not in a commit message and not in the
                PR description.
              </p>
              <p>
                Never put GitHub @-prefixed usernames in commits and PR
                descriptions; the latter because usernames in the description
                are copied into the merge commit by the merge script. This can
                cause endless annoying notifications for those concerned. An
                <a href="https://github.com/bitcoin-core/bitcoin-maintainer-tools/pull/32">update</a>
                to the merge script now warns maintainers if a merge message
                contains a @username, but it's better not to add them to begin
                with.
              </p>
              <p>
                Ask yourself how others will see your PR. Try to only file PRs
                that people will be motivated to review and that are worth
                merging, for both Bitcoin and your track record. Your PRs will
                receive more attention from the contributors and maintainers and
                be merged more quickly.
              </p>
              <p>
                Scale up your PR contributions gradually in line with your
                ability and understanding of the project, process, and codebase.
              </p>

              <h4 id="keep-reviewing">Keep reviewing</h4>
              <p>
                Continue to do more reviewing and testing than adding PRs to the
                backlog. Reviewing 5 to 15 PRs for every PR you open is a good
                range.
              </p>
              <p>
                If you are a good reviewer and begin building a reputation and
                appreciation for your help in moving the project forward,
                maintainers and other contributors may reciprocate by reviewing
                your work more quickly as well.
              </p>
              <p>
                Happy contributing!
              </p>
              <p>Cheers,</p>
              <p>Jon Atack</p>
            </article>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
